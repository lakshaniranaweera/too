<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Memory Game</title>
<link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&family=Bangers&display=swap" rel="stylesheet">
<style>
/* Your full CSS stays exactly as before */
body, html {margin:0;padding:0;width:100%;height:100%;font-family:Arial,sans-serif;text-align:center;overflow:hidden;}
#gamePage h2 { font-family:'Raphaël Ronot',cursive;font-size:60px;color:oklch(99.779% 0.00104 11.135);text-shadow:2px 2px 8px #000;margin-top:40px;margin-bottom:30px;animation:pop 0.8s ease forwards; }
@keyframes pop {0%{transform:scale(0.7);opacity:0;}60%{transform:scale(1.2);opacity:1;}100%{transform:scale(1);} }
#videoPage,#startPage,#gamePage,.winnerPage{display:none;top:0;left:0;width:100%;height:100%;position:absolute;top:0;left:0;justify-content:center;align-items:center;flex-direction:column;background-size:100% 100%;background-attachment:fixed;}
#videoPage { display:flex;background:#000; }
#videoPage video { width:100%; height:100%; object-fit:cover; }
#videoPage .touchMsg { position:absolute; bottom:20px;color:#fff;font-size:28px;font-weight:bold;text-shadow:2px 2px 5px #000;}
#startPage { background:url('background.jpg') no-repeat center center/cover; display:flex; background-size:100% 100%; }
#startPage img { width:600px; height:auto; display:block; margin:0 auto; }
button { padding:25px 55px;font-size:40px;border:none;border-radius:90px;cursor:pointer;background:#007bff;color:#fff;margin-top:60px;}
#gamePage { flex-direction:column; background:url('back.png') no-repeat center center/cover; background-size:100% 100%; }
.grid { display:grid; grid-template-columns:repeat(4,160px); grid-gap:100px; justify-content:start; padding-right:75px; margin-top:60px auto 0 auto; }
.card { width:240px;height:240px;perspective:1000px;cursor:pointer;position:relative;}
.card-inner { position:relative;width:100%;height:100%;transform-style:preserve-3d;transition:transform 0.3s;}
.card.flipped .card-inner { transform:rotateY(180deg); }
.card-front,.card-back { position:absolute;width:100%;height:100%;backface-visibility:hidden;border-radius:10px;}
.grid .card:nth-child(1) .card-front,
.grid .card:nth-child(3) .card-front,
.grid .card:nth-child(6) .card-front,
.grid .card:nth-child(8) .card-front,
.grid .card:nth-child(9) .card-front,
.grid .card:nth-child(11) .card-front {
  background-image: url('logo.png');
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
}
.grid .card:nth-child(2) .card-front,
.grid .card:nth-child(4) .card-front,
.grid .card:nth-child(5) .card-front,
.grid .card:nth-child(7) .card-front,
.grid .card:nth-child(10) .card-front,
.grid .card:nth-child(12) .card-front {
  background-image: url('logo.png');
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
}
.card-back { transform:rotateY(180deg); background-size:cover; background-position:center;}
.card.selected .card-front { box-shadow:0 0 20px 5px green; }
@keyframes popMatch { 0%{transform:scale(1);}50%{transform:scale(1.3);}100%{transform:scale(1);} }
.winnerPage { display:none; flex-direction:column; justify-content:center; align-items:center; color:#fff; text-align:center; padding:10px; position:fixed; background:url('back2.jpg') no-repeat center center/cover; background-size:100% 100%; background-attachment:fixed; }
.winnerPage h1 { font-size:64px; font-family:'René Bieder',cursive; color:#ffeb3b;margin-bottom:20px; animation:pop 0.6s ease forwards; }
.winnerPage h2 { font-size:50px; font-family:'Raphaël Ronot',cursive;color:#fff; line-height:1.5;margin:10px 0;}
.winnerPage img { max-width:600px;width:100%; height:auto; margin-bottom:20px;}
#countdown { position:absolute; bottom:300px;font-size:90px;font-weight:bold;color:yellow;text-shadow:2px 2px 5px #000;}
</style>
</head>
<body>

<!-- Audio -->
<audio id="startSound" src="start.mp3" loop></audio>
<audio id="gameSound" src="start.mp3" loop></audio>
<audio id="selectSound" src="select.mp3"></audio>
<audio id="winnerSound" src="winner.mp3"></audio>
<audio id="tryAgainSound" src="tryagain.mp3"></audio>

<!-- Video Page -->
<div id="videoPage" >
  <video autoplay id="introVideo">
    <source src="intro2.mp4" type="video/mp4">
  </video>
  <div class="touchMsg"></div>
</div>

<!-- Start Page -->
<div id="startPage">
  <img src="logo (2).png" alt="Book Voucher">
  <button onclick="startGame()">Let's Go</button>
</div>

<!-- Game Page -->
<div id="gamePage">
  <h2>Find the Matching Pairs</h2>
  <div class="grid" id="gameBoard"></div>
  <div id="countdown">20</div>
</div>

<!-- Winner Pages -->
<div id="winnerDrink" class="winnerPage">
  <h1>CONGRATULATIONS!</h1>
  <img src="vb.jpg" alt="Drink Coupon" width="500" height="400">
  <h2>Coupon for a drink item from the Knorr stall</h2>
</div>
<div id="winnerFood" class="winnerPage">
  <h1>CONGRATULATIONS!</h1>
  <img src="food.jpg" alt="Knorr Food" width="500" height="400">
  <h2>10% off on any food items from the Knorr food stall</h2>
</div>
<div id="winnerKnorrBox" class="winnerPage">
  <h1>CONGRATULATIONS!</h1>
  <img src="n.png" alt="Knorr Box" width="300" height="200">
  <h2>You’ve received a Knorr Shell Box Sample</h2>
</div>
<div id="winnerVaseline" class="winnerPage">
  <h1>CONGRATULATIONS!</h1>
  <img src="VL1.png" alt="Vaseline">
  <h2>You’ve won a Vaseline Sample</h2>
</div>
<div id="winnerKMF" class="winnerPage">
  <h1>CONGRATULATIONS!</h1>
  <img src="um.png" alt="KMF Sachet" width="300" height="200">
  <h2>You’ve got a KMF Sachet Sample</h2>
</div>
<div id="winnerCMP" class="winnerPage">
  <h1>CONGRATULATIONS!</h1>
  <img src="k.png" alt="CMP Dockets" width="300" height="200">
  <h2>You’ve won a CMP Docket</h2>
</div>

<!-- Try Again -->
<div id="tryAgainPage" class="winnerPage">
  <h1>ALMOST MAGIC!</h1>
  <img src="mmm.png" alt="Try Again" width="300" height="200">
  <h2>Your Better luck has run out</h2>
</div>

<!-- Timeout -->
<div id="timeoutPage" class="winnerPage">
  <h1>OUT OF SECONDS!</h1>
  <img src="time.png" alt="Timeout" width="300" height="200">
  <h2>Better luck Next Time</h2>
</div>

<script>
let prizes = {
  "Drink Coupon":5,
  "Food Coupon":35,
  "Knorr Shell Box":13,
  "Vaseline Sample":34,
  "KMF Sachet":14,
  "CMP Docket":14
};

let selectedCards=[], matchedPairs=0, countdown=20, countdownInterval;
const startSound=document.getElementById('startSound');
const gameSound=document.getElementById('gameSound');
const selectSound=document.getElementById('selectSound');
const winnerSound=document.getElementById('winnerSound');
const tryAgainSound=document.getElementById('tryAgainSound');

window.onload = ()=>{
  const video = document.getElementById('introVideo');
  document.getElementById('videoPage').style.display='flex';
  video.onended = () => { goStart(); };
};

function goStart(){
  const video=document.getElementById('introVideo');
  video.pause();
  document.getElementById('videoPage').style.display='none';
  document.getElementById('startPage').style.display='flex';
  startSound.play();
}

function startGame(){
  document.getElementById('startPage').style.display='none';
  document.getElementById('videoPage').style.display='none'; 
  document.getElementById('gamePage').style.display='flex';
  initBoard();
  startCountdown();
  gameSound.currentTime=0;
  gameSound.play();
}

function initBoard(){
  matchedPairs=0;
  selectedCards=[];
  const images=['1.png','2.png','3.jpg','4.png','5.png','6.png'];
  const cardImages=[...images,...images].sort(()=>0.5-Math.random());
  const board=document.getElementById('gameBoard');
  board.innerHTML='';
  cardImages.forEach((img)=>{
    const card=document.createElement('div');
    card.classList.add('card');
    card.innerHTML=`<div class="card-inner"><div class="card-front"></div><div class="card-back" style="background-image:url('${img}')"></div></div>`;
    board.appendChild(card);
    card.addEventListener('click',()=>flipCard(card,img));
  });
}

function flipCard(card,img){
  if(selectedCards.length<2&&!card.classList.contains('flipped')){
    card.classList.add('flipped','selected');
    selectSound.currentTime=0; selectSound.play();
    selectedCards.push({card,img});
    if(selectedCards.length===2) setTimeout(checkMatch,400);
  }
}

function checkMatch(){
  const [c1,c2]=selectedCards;
  if(c1.img===c2.img){
    matchedPairs++;
    c1.card.classList.add('matched'); c2.card.classList.add('matched');
    if(matchedPairs===6){ clearInterval(countdownInterval); showWinner(); }
  } else { c1.card.classList.remove('flipped','selected'); c2.card.classList.remove('flipped','selected'); }
  selectedCards=[];
}

function startCountdown(){
  countdown=18;
  document.getElementById('countdown').innerText=countdown;
  countdownInterval=setInterval(()=>{
    countdown--;
    document.getElementById('countdown').innerText=countdown;
    if(countdown<=0){clearInterval(countdownInterval); showTimeout();}
  },1000);
}

function showWinner(){
  gameSound.pause();
  winnerSound.currentTime=0; winnerSound.play();
  document.getElementById('gamePage').style.display='none';
  
  // Check if gifts are left
  let available = Object.entries(prizes).filter(([_,count])=>count>0);
  if(available.length===0){
    showTryAgain();
    return;
  }
  
  let [gift]=available[Math.floor(Math.random()*available.length)];
  prizes[gift]--;
  
  const allWinnerPages = document.querySelectorAll('.winnerPage');
  allWinnerPages.forEach(p=>p.style.display='none'); 
  let winnerPage;
  if(gift==="Drink Coupon") winnerPage=document.getElementById("winnerDrink");
  if(gift==="Food Coupon") winnerPage=document.getElementById("winnerFood");
  if(gift==="Knorr Shell Box") winnerPage=document.getElementById("winnerKnorrBox");
  if(gift==="Vaseline Sample") winnerPage=document.getElementById("winnerVaseline");
  if(gift==="KMF Sachet") winnerPage=document.getElementById("winnerKMF");
  if(gift==="CMP Docket") winnerPage=document.getElementById("winnerCMP");
  
  winnerPage.style.display='flex';
  winnerPage.onclick = ()=>goVideo();
}

function showTryAgain(){
  gameSound.pause();
  tryAgainSound.currentTime=0; tryAgainSound.play();
  document.getElementById('gamePage').style.display='none';
  const page=document.getElementById('tryAgainPage');
  page.style.display='flex';
  page.onclick = ()=>goVideo();
}

function showTimeout(){
  gameSound.pause();
  tryAgainSound.currentTime=0; tryAgainSound.play();
  document.getElementById('gamePage').style.display='none';
  const page=document.getElementById('timeoutPage');
  page.style.display='flex';
  page.onclick = ()=>goVideo();
}

function goVideo(){
  document.querySelectorAll('.winnerPage').forEach(p=>p.style.display='none');
  document.getElementById('startPage').style.display='none';
  document.getElementById('gamePage').style.display='none';
  const video=document.getElementById('introVideo');
  document.getElementById('videoPage').style.display='flex';
  video.currentTime=0;
  video.play();
  startSound.pause(); gameSound.pause(); winnerSound.pause(); tryAgainSound.pause();
}
</script>
</body>
</html>
